<img width="683" height="612" alt="2024-2-kol" src="https://github.com/user-attachments/assets/49800986-c70a-43bc-bf07-a122aa0927fc" />

**<mark>1. zadatak</mark>**

```sql
CREATE VIEW STATISTIKA_ZAPOSLENI
AS
SELECT
  Z.IME,
  Z.PREZIME,
  COUNT(DISTINCT RM.POZICIJA) AS BROJ_POZICIJA,
  AVG(RM.DATUMDO - RM.DATUMOD) AS VREME
FROM
  ZAPOSLENI Z
INNER JOIN
  RADNO_MESTO RM
ON
  Z.JMBG = RM.ZJMBG
WHERE
  RM.DATUMDO IS NOT NULL -- uzimamo sve prethodne (zavrsene) pozicije
AND NOT EXISTS -- izbacujemo onu poziciju na kojoj trenutno radi a koja se pojavljuje medju prethodnim pozicijama
  (SELECT 1
  FROM
    RADNO_MESTO RM1
  WHERE
    RM1.ZJMBG = Z.JMBG
  AND
    RM1.DATUMDO IS NULL
  AND
    RM1.POZICIJA = RM.POZICIJA)
GROUP BY
  Z.IME,
  Z.PREZIME;


SELECT *
FROM
  STATISTIKA_ZAPOSLENI
WHERE
  BROJ_POZICIJA > 1
AND
  VREME > 300;
```

**<mark>2. zadatak</mark>**

```sql
-- ovaj VIEW uzima sve radnike koji su radili u kompaniji koja je u Nisu i racuna na koliko pozicija je svaki od njih tamo radio

CREATE VIEW ZAPOSLENJE
AS
SELECT
  Z.JMBG,
  COUNT(*) AS RADNO_MESTO
FROM
  ZAPOSLENI Z
INNER JOIN
  RADNO_MESTO RM
ON
  Z.JMBG = RM.ZJMBG
INNER JOIN
  KOMPANIJA K
ON
  K.IDK = RM.IDK
WHERE
  K.ADRESA = 'Nis'
AND
  RM.DATUMDO IS NOT NULL
GROUP BY
  Z.JMBG;


UPDATE
  ZAPOSLENI Z
SET
  Z.PLATA = Z.PLATA * 1.15
WHERE EXISTS
(SELECT 1
FROM
  ZAPOSLENJE ZAP, RADNO_MESTO RM
WHERE
  ZAP.JMBG = Z.JMBG
AND
  RM.ZJMBG = Z.JMBG
AND
  RM.DATUMDO IS NULL
AND
  ZAP.RADNO_MESTO >= 1); 
```

**<mark>3. zadatak</mark>**

```sql
-- ovaj VIEW racuna prethodni radni staz za svakog zaposlenog

CREATE VIEW RADNI_STAZ
AS
SELECT
  Z.JMBG,
  SUM(RM.DATUMDO - RM.DATUMOD) AS PRETHODNI_RADNI_STAZ
FROM
  ZAPOSLENI Z
INNER JOIN
  RADNO_MESTO RM
ON
  Z.JMBG = RM.ZJMBG
WHERE
  RM.DATUMDO IS NOT NULL
GROUP BY
  Z.JMBG;


DELETE FROM
  RADNO_MESTO RM
WHERE
  RM.DATUMDO IS NULL
AND EXISTS
  (SELECT 1
  FROM
    KOMPANIJA K, RADNI_STAZ RS
  WHERE
    K.IDK = RM.IDK
  AND
    RS.JMBG = RM.ZJMBG
  AND
    K.GODINA_OSN < 2000
  AND
    RS.PRETHODNI_RADNI_STAZ > 1000);
```



