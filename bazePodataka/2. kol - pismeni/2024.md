<img width="683" height="612" alt="2024-2-kol" src="https://github.com/user-attachments/assets/49800986-c70a-43bc-bf07-a122aa0927fc" />

**<mark>1. zadatak</mark>**

```sql
CREATE VIEW STATISTIKA_ZAPOSLENI
AS
SELECT
  Z.IME,
  Z.PREZIME,
  COUNT(DISTINCT RM.POZICIJA) AS BROJ_POZICIJA,
  AVG(RM.DATUMDO - RM.DATUMOD) AS VREME
FROM
  ZAPOSLENI Z
INNER JOIN
  RADNO_MESTO RM
ON
  Z.JMBG = RM.ZJMBG
WHERE
  RM.DATUMDO IS NOT NULL -- uzimamo sve prethodne (zavrsene) pozicije
AND NOT EXISTS -- izbacujemo onu poziciju na kojoj trenutno radi a koja se pojavljuje medju prethodnim pozicijama
  (SELECT 1
  FROM
    RADNO_MESTO RM1
  WHERE
    RM1.ZJMBG = Z.JMBG
  AND
    RM1.DATUMDO IS NULL
  AND
    RM1.POZICIJA = RM.POZICIJA)
GROUP BY
  Z.IME,
  Z.PREZIME;


SELECT *
FROM
  STATISTIKA_ZAPOSLENI
WHERE
  BROJ_POZICIJA > 1
AND
  VREME > 300;
```
