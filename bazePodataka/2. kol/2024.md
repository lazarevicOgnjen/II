<img width="683" height="612" alt="Screenshot 2025-08-05 183756" src="https://github.com/user-attachments/assets/28758206-eee0-43f7-91c1-262208b3e0d1" />

---

**<mark>1. zadatak</mark>**

```sql
CREATE VIEW STATISTIKA_ZAPOSLENI
AS
SELECT
  Z.IME,
  Z.PREZIME,
  COUNT(*) AS BROJ_POZICIJA,
  AVG(RM.DATUMDO - RM.DATUMOD) AS VREME
FROM
  ZAPOSLENI Z
INNER JOIN
  RADNO_MESTO RM
ON
  Z.JMBG = RM.ZJMBG
WHERE
  RM.DATUMDO IS NOT NULL
GROUP BY
  Z.IME,
  Z.PREZIME;

SELECT *
FROM
  STATISTIKA_ZAPOSLENI
WHERE
  BROJ_POZICIJA > 1
AND
  VREME > 300;
```

**<mark>2. zadatak</mark>**

```sql
CREATE VIEW RADNICI
AS
SELECT
  Z.JMBG,
  COUNT(*) AS BPP
-- BPP je skraceno za broj_prethodnih_pozicija
FROM
  ZAPOSLENI Z
INNER JOIN
  RADNO_MESTO RM
ON
  Z.JMBG = RM.ZJMBG
INNER JOIN
  KOMPANIJA K
ON
  K.IDK = RM.IDK
WHERE
  RM.DATUMDO IS NOT NULL
AND
  K.ADRESA = 'Nis'
GROUP BY
  Z.JMBG;

UPDATE
  ZAPOSLENI Z
SET
  PLATA = PLATA * 1.15
WHERE EXISTS
  (SELECT 1
  FROM
    RADNO_MESTO RM
  INNER JOIN
    RADNICI R
  ON
    R.JMBG = Z.JMBG
  WHERE
    RM.ZJMBG = Z.JMBG
  AND
    R.BPP >= 1
  AND
    RM.DATUMDO IS NULL); 
      
```






